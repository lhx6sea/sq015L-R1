/*  ************************************************************************************
*								上海芯圣电子股份有限公司
*								    www.holychip.cn
*	************************************************************************************
*	@Author				LiFei
*	@File				inital.c
*	@Library Version	V1.0.0.0
*	@Date				2018.01.15
*	************************************************************************************
*/
//┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
//┃系统初始化							  						  ┃
//┃Version:V1.00										 		  ┃
//┃Functio:		 						  					  ┃
//┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

#include	"include.h"


/*
;***************************************************************************************
;                            _____________
;                          _|             |_
;                 <P+> VDD|_ 1          8  _|VSS <P->
;                          _|             |_
;                 <--> PB5|_ 2          7  _|PB0 <-->
;                          _|             |_
;                 <--> PB4|_ 3          6  _|PB1 <-->
;                          _|             |_
;                 ---> PB3|_ 4          5  _|PB2 <-->
;                           |_____________|
;
;***************************************************************************************
*/


/*******************************************************************
*|``````````````````````````````````````````````````````````````````
*|	端口初始化: 方向,上下拉,开漏,推挽,电流大小
*|__________________________________________________________________
*/
void inital(void)
{	
	//PB3 输入, 上拉; 其他IO,输出,没有上下拉
	PORTB=0X08;				//端口输出电平设置  1=高电平,	0=低电平
	TRISB=0X08;				//输入 or 输出设置  1=输入in,   0=输出out	  
	
		
	//PHCON(0x0D):			// --  /PHB3  /PHB5  /PHB4 :: -  /PHB2  /PHB1  /PHB0 	
	PHCON =0X37;			//上拉设置		0=enable; 	1=Disabled
	
	//PDCON(0x0B):    		//GPR  /PDB2  /PDB1  /PDB0 :: -  -  -  - 
	PDCON =0XFF;			//下拉设置		0=enable;	1=Disabled 
	
	//ODCON(0x0C):			// ---  ----   ODB5   ODB4 :: ODB3  ODB2  ODB1  ODB0 
	ODCON =0X30;			//开漏设置 		0=推挽  ;1=开漏
	
	PORTB=0X08;
}



/*******************************************************************
*|``````````````````````````````````````````````````````````````````
*|	系统初始化: 时钟,中断,看门狗,复位; Fosc=8Mhz/4T, Fsys=2Mhz
*|__________________________________________________________________
*/
void sysinitial(void)
{
	//INTECON(0x0E)    		// GIE  -b6- -b5- -b4-  ::  -  INTE  PBIE  T0IE 
	INTECON=0x83;			// Timer0,IO电平变化中断使能
	
	//OPTION:  				// - INTEDG  T0CS  T0SE :: PSA  PS2  PS1  PS0	
	OPTION=0X02;			// Ftimer0 1/8   128/64/32/16::8/4/2/1
	
	T0=160;					// 8位, 溢出中断; 不可重载  4T/160
		
	asm(clrwdt);
	
	//PCON(0x08)			// WDTEN  EIS  -  - :: -  -  -  - 
	PCON=0X00;				// WDTEN: 1=软件使能WDT
	
	IOCB=0x08;				//PB3, 按键变化中断/唤醒	
}